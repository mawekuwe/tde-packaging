#!/usr/bin/make -f

include /usr/share/cdbs/1/rules/debhelper.mk

DEB_CONFIGURE_INCLUDEDIR := /opt/trinity/include/kde
DEB_CONFIGURE_MANDIR := /opt/trinity/share/man
DEB_CONFIGURE_PREFIX := /opt/trinity
DEB_CONFIGURE_INFODIR := /opt/trinity/share/info

cdbs_configure_flags := --with-qt-dir=/usr/share/qt3 --disable-rpath --with-xinerama $(cdbs_kde_enable_final) $(cdbs_kde_enable_debug)

DEB_COMPRESS_EXCLUDE=.docbook
DEB_SCONS_PREFIX=/opt/trinity

CONFIG_STATUS=$(DEB_BUILDDIR)/config.status
SCONS_CMD=/usr/bin/scons

common-configure-arch common-configure-indep:: common-configure-impl
common-configure-impl:: $(CONFIG_STATUS)
$(CONFIG_STATUS):
	env PATH=/opt/trinity/bin:$(PATH) $(SCONS_CMD) configure prefix=$(DEB_DESTDIR)$(DEB_SCONS_PREFIX)
	touch $(CONFIG_STATUS)

common-build-arch common-build-indep:: common-build-impl
common-build-impl::
	env PATH=/opt/trinity/bin:$(PATH) $(SCONS_CMD)
	rm -f doc/en/index.cache.bz2

common-install-arch common-install-indep:: common-install-impl
common-install-impl::
	env PATH=/opt/trinity/bin:$(PATH) DESTDIR=$(DEB_DESTDIR) $(SCONS_CMD) install

clean::
	rm -rf build cache scons-mini
	rm -f admin/*.pyc $(CONFIG_STATUS)

DEB_INSTALL_DOCS_kio-locate-trinity := -XREADME -XNEWS -XTODO -XAUTHORS
